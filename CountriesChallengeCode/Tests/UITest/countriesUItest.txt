import XCTest

final class CountriesUITests: XCTestCase {

    var app: XCUIApplication!

    override func setUp() {
        super.setUp()
        continueAfterFailure = false
        app = XCUIApplication()
        app.launch()
    }


    func test_countryListLoads_andDisplaysFirstCell() {
        let firstCell = app.tables.cells.element(boundBy: 0)
        XCTAssertTrue(firstCell.waitForExistence(timeout: 5), "Country list did not load in time")
    }


    func test_searchFiltersCountries_byName() {
        let searchField = app.searchFields.firstMatch
        XCTAssertTrue(searchField.exists)
        
        searchField.tap()
        searchField.typeText("India")

        let indiaCell = app.tables.cells.staticTexts["India"]
        XCTAssertTrue(indiaCell.waitForExistence(timeout: 3), "Search did not return expected result")
    }


    func test_tapOnCountry_showsDetailScreen() {
        let firstCell = app.tables.cells.element(boundBy: 0)
        XCTAssertTrue(firstCell.exists)
        firstCell.tap()

        XCTAssertTrue(app.staticTexts["Capital"].exists)
        XCTAssertTrue(app.staticTexts["Region"].exists)
    }
}
